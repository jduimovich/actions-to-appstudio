# 💁 This demo will use cached OIDC to access app studio

name: List-App-Studio-Apps 
env: 
  KUBE_CONFIG: ${{ secrets.KUBE_CONFIG }}
  OIDC: ${{ secrets.OIDC }} 
on: 
  push: 
    branches: [ "main" ] 
jobs:
  list-apps:
    name: List App Studio Apps
    runs-on: ubuntu-18.04  
    steps:
    - name: Initialize App Studio Access
      run: |  
        brew install int128/kubelogin/kubelogin
        mkdir -p ~/.kube ~/.kube/cache 
        echo "${{ env.KUBE_CONFIG }}" | base64 --decode > ~/.kube/config 
        echo "${{ env.OIDC }}" | base64 --decode > ~/.kube/cache/oidc.tar  
        cd ~/.kube/cache
        tar xvf oidc.tar   
        oc config use-context appstudio
    - name: List Applications
      run: |   
        oc get application
